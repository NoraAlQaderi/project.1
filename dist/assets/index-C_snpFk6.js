(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const g=document.getElementById("uploadArea"),I=document.getElementById("fileInput"),E=document.getElementById("fileContainer"),m=document.getElementById("originalImage"),l=document.getElementById("originalVideo"),y=document.getElementById("removeBtn"),p=document.getElementById("loading"),h=document.getElementById("comparisonContainer"),j=document.getElementById("beforeImage"),b=document.getElementById("afterImage"),J=document.getElementById("beforeVideo"),T=document.getElementById("afterVideo"),d=document.getElementById("downloadBtn"),Q=document.getElementById("newFileBtn"),x=document.getElementById("themeToggle"),Z=document.querySelectorAll(".sample-item"),B=document.getElementById("sliderHandle"),ee=document.getElementById("comparisonSlider"),P=document.querySelectorAll(".tab-btn"),$=document.getElementById("uploadIcon"),z=document.getElementById("uploadText"),R=document.getElementById("uploadSubtext"),O=document.getElementById("removeBtnText"),A=document.getElementById("downloadBtnText"),N=document.getElementById("newFileBtnText"),V=document.getElementById("loadingText"),U=document.getElementById("sampleTitle"),k=document.getElementById("imageComparison"),S=document.getElementById("videoComparison"),te=document.getElementById("fileName"),ne=document.getElementById("fileSize"),C=document.getElementById("videoDuration"),oe=document.getElementById("duration");document.getElementById("progressBar");const M=document.getElementById("progressFill"),F=document.getElementById("progressText"),se="zK811CojSrKBDMmXPgB1SyYv";let r="image",u=null,f=null;x.addEventListener("click",()=>{document.body.classList.toggle("dark-mode");const e=x.querySelector("i");document.body.classList.contains("dark-mode")?(e.classList.remove("fa-moon"),e.classList.add("fa-sun"),localStorage.setItem("theme","dark")):(e.classList.remove("fa-sun"),e.classList.add("fa-moon"),localStorage.setItem("theme","light"))});P.forEach(e=>{e.addEventListener("click",()=>{P.forEach(n=>n.classList.remove("active")),e.classList.add("active");const t=e.dataset.type;r=t,q(t),K()})});function q(e){e==="image"?($.className="fas fa-cloud-upload-alt upload-icon",z.textContent="اسحب وأفلت صورتك هنا",R.textContent="أو انقر لاختيار ملف (JPG, PNG, WEBP)",I.accept="image/*",O.textContent="إزالة الخلفية",A.textContent="تحميل الصورة",N.textContent="صورة جديدة",V.textContent="جاري معالجة الصورة بالذكاء الاصطناعي...",U.textContent="أو جرب إحدى هذه الصور:"):($.className="fas fa-video upload-icon",z.textContent="اسحب وأفلت فيديوك هنا",R.textContent="أو انقر لاختيار ملف (MP4, MOV, AVI)",I.accept="video/*",O.textContent="إزالة خلفية الفيديو",A.textContent="تحميل الفيديو",N.textContent="فيديو جديد",V.textContent="جاري معالجة الفيديو بالذكاء الاصطناعي...",U.textContent="أو جرب إحدى هذه الفيديوهات:")}g.addEventListener("click",()=>I.click());g.addEventListener("dragover",ae);g.addEventListener("dragleave",re);g.addEventListener("drop",ie);I.addEventListener("change",ce);function ae(e){e.preventDefault(),g.classList.add("dragover")}function re(e){e.preventDefault(),g.classList.remove("dragover")}function ie(e){e.preventDefault(),g.classList.remove("dragover");const t=e.dataTransfer.files;t.length>0&&H(t[0])}function ce(e){const t=e.target.files[0];t&&H(t)}function H(e){const t=e.type.startsWith("image/"),n=e.type.startsWith("video/");if(r==="image"&&!t){i("يرجى اختيار ملف صورة صحيح","error");return}if(r==="video"&&!n){i("يرجى اختيار ملف فيديو صحيح","error");return}const o=r==="image"?10*1024*1024:100*1024*1024;if(e.size>o){i(`حجم الملف كبير جداً. يرجى اختيار ${r==="image"?"صورة":"فيديو"} أصغر من ${r==="image"?"10 ميجابايت":"100 ميجابايت"}`,"error");return}u=e,le(e),X(e)}function le(e){const t=new FileReader;t.onload=n=>{r==="image"?(m.src=n.target.result,m.style.display="block",l.style.display="none"):(l.src=n.target.result,l.style.display="block",m.style.display="none",l.addEventListener("loadedmetadata",()=>{const o=Math.floor(l.duration/60),s=Math.floor(l.duration%60);oe.textContent=`${o}:${s.toString().padStart(2,"0")}`,C.style.display="flex"})),E.style.display="block",h.style.display="none",i(`تم تحميل ${r==="image"?"الصورة":"الفيديو"} بنجاح!`,"success")},t.readAsDataURL(e)}function X(e){te.textContent=e.name,ne.textContent=de(e.size),r==="video"?C.style.display="flex":C.style.display="none"}function de(e){if(e===0)return"0 بايت";const t=1024,n=["بايت","كيلوبايت","ميجابايت","جيجابايت"],o=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,o)).toFixed(2))+" "+n[o]}Z.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.type;if(t!==r){i(`يرجى التبديل إلى تبويب ${t==="image"?"الصور":"الفيديوهات"} أولاً`,"warning");return}r==="image"&&(m.src=e.src,m.style.display="block",l.style.display="none"),E.style.display="block",h.style.display="none",fetch(e.src).then(n=>n.blob()).then(n=>{u=new File([n],"sample.jpg",{type:"image/jpeg"}),X(u),i("تم تحميل الملف التجريبي!","success")}).catch(()=>{i("حدث خطأ في تحميل الملف التجريبي","error")})})});y.addEventListener("click",async()=>{if(u){p.style.display="block",y.disabled=!0,E.style.display="none",M.style.width="0%",F.textContent="0%";try{r==="image"?await me():await ge()}catch(e){console.error("خطأ في معالجة الملف:",e),i(`حدث خطأ أثناء معالجة ${r==="image"?"الصورة":"الفيديو"}. يرجى المحاولة مرة أخرى.`,"error"),p.style.display="none",E.style.display="block",y.disabled=!1}}});async function me(){try{W();const e=new FormData;e.append("image_file",u),e.append("size","auto");const t=await fetch("https://api.remove.bg/v1.0/removebg",{method:"POST",headers:{"X-Api-Key":se},body:e});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=await t.blob();f=n;const o=URL.createObjectURL(n);j.src=m.src,b.src=o,k.style.display="block",S.style.display="none",p.style.display="none",h.style.display="block",y.disabled=!1,i("تم إزالة الخلفية بنجاح!","success")}catch(e){console.error("خطأ في API:",e),i("جاري استخدام المعالجة المحلية...","warning"),await ue()}}async function ue(){return new Promise(e=>{setTimeout(()=>{const t=document.createElement("canvas"),n=t.getContext("2d"),o=new Image;o.onload=()=>{t.width=o.width,t.height=o.height,n.drawImage(o,0,0);const s=n.getImageData(0,0,t.width,t.height),a=s.data;for(let c=0;c<a.length;c+=4){const v=a[c],L=a[c+1],w=a[c+2];(v+L+w)/3>180||Math.abs(v-L)<30&&Math.abs(L-w)<30&&Math.abs(v-w)<30?a[c+3]=0:a[c+3]=Math.min(255,a[c+3]*1.1)}n.putImageData(s,0,0),t.toBlob(c=>{f=c;const v=URL.createObjectURL(c);j.src=m.src,b.src=v,k.style.display="block",S.style.display="none",p.style.display="none",h.style.display="block",y.disabled=!1,i("تم إزالة الخلفية باستخدام المعالجة المحلية!","success"),e()},"image/png")},o.src=m.src},2e3)})}async function ge(){return new Promise(e=>{W(),setTimeout(()=>{f=u,J.src=l.src,T.src=l.src,k.style.display="none",S.style.display="block",p.style.display="none",h.style.display="block",y.disabled=!1,i("تم معالجة الفيديو! (نسخة تجريبية)","success"),e()},5e3)})}function W(){let e=0;const t=setInterval(()=>{e+=Math.random()*15,e>95&&(e=95),M.style.width=e+"%",F.textContent=Math.round(e)+"%",e>=95&&clearInterval(t)},200)}Q.addEventListener("click",()=>{K(),i(`جاهز لـ${r==="image"?"صورة":"فيديو"} جديد!`,"success")});function K(){E.style.display="none",h.style.display="none",p.style.display="none",I.value="",u=null,f=null,B.style.left="50%",b.style.clipPath="polygon(50% 0%, 100% 0%, 100% 100%, 50% 100%)",T.style.clipPath="polygon(50% 0%, 100% 0%, 100% 100%, 50% 100%)",M.style.width="0%",F.textContent="0%"}let D=!1;B.addEventListener("mousedown",Y);document.addEventListener("mousemove",G);document.addEventListener("mouseup",_);B.addEventListener("touchstart",Y);document.addEventListener("touchmove",G);document.addEventListener("touchend",_);function Y(e){D=!0,e.preventDefault()}function G(e){if(!D)return;const t=ee.getBoundingClientRect(),n=(e.clientX||e.touches[0].clientX)-t.left,o=Math.max(0,Math.min(100,n/t.width*100));B.style.left=o+"%",r==="image"?b.style.clipPath=`polygon(${o}% 0%, 100% 0%, 100% 100%, ${o}% 100%)`:T.style.clipPath=`polygon(${o}% 0%, 100% 0%, 100% 100%, ${o}% 100%)`}function _(){D=!1}d.addEventListener("click",()=>{if(!f)return;const e=document.createElement("a");e.href=URL.createObjectURL(f);const t=r==="image"?"png":"mp4",n=r==="image"?"removed-background":"processed-video";e.download=`${n}-${Date.now()}.${t}`,e.click();const o=d.innerHTML;d.innerHTML='<i class="fas fa-check"></i> تم التحميل!',d.style.background="var(--success)",d.style.borderColor="var(--success)",setTimeout(()=>{d.innerHTML=o,d.style.background="",d.style.borderColor=""},2e3),i(`تم تحميل ${r==="image"?"الصورة":"الفيديو"} بنجاح!`,"success")});function i(e,t="info"){const n=document.createElement("div");n.className=`notification notification-${t}`,n.innerHTML=`
        <i class="fas ${ye(t)}"></i>
        <span>${e}</span>
    `,Object.assign(n.style,{position:"fixed",top:"20px",right:"20px",background:pe(t),color:"white",padding:"15px 20px",borderRadius:"10px",boxShadow:"var(--shadow-lg)",zIndex:"1000",display:"flex",alignItems:"center",gap:"10px",fontSize:"14px",fontWeight:"600",transform:"translateX(100%)",transition:"all 0.3s ease",maxWidth:"350px"}),document.body.appendChild(n),setTimeout(()=>{n.style.transform="translateX(0)"},100),setTimeout(()=>{n.style.transform="translateX(100%)",setTimeout(()=>{document.body.contains(n)&&document.body.removeChild(n)},300)},4e3)}function ye(e){switch(e){case"success":return"fa-check-circle";case"error":return"fa-exclamation-circle";case"warning":return"fa-exclamation-triangle";default:return"fa-info-circle"}}function pe(e){switch(e){case"success":return"var(--success)";case"error":return"var(--error)";case"warning":return"var(--warning)";default:return"var(--primary)"}}document.addEventListener("DOMContentLoaded",()=>{localStorage.getItem("theme")==="dark"&&(document.body.classList.add("dark-mode"),x.querySelector("i").classList.remove("fa-moon"),x.querySelector("i").classList.add("fa-sun")),document.querySelectorAll(".feature-card, .sample-item").forEach((n,o)=>{n.style.opacity="0",n.style.transform="translateY(20px)",setTimeout(()=>{n.style.transition="all 0.5s ease",n.style.opacity="1",n.style.transform="translateY(0)"},o*100)}),q("image"),i("مرحباً بك في Remove Images & Videos Background! 🎉","success")});window.addEventListener("error",e=>{console.error("خطأ في التطبيق:",e.error),i("حدث خطأ غير متوقع","error")});document.addEventListener("dragover",e=>{e.preventDefault()});document.addEventListener("drop",e=>{e.preventDefault()});
